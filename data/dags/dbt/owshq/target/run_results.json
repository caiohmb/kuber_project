{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.7", "generated_at": "2024-10-19T01:34:42.028315Z", "invocation_id": "5a611128-02c7-4933-8419-2ef508bdde7d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:01.154938Z", "completed_at": "2024-10-19T01:34:01.166403Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:01.168777Z", "completed_at": "2024-10-19T01:34:05.672589Z"}], "thread_id": "Thread-1", "execution_time": 4.52597188949585, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4500, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.mongodb_rides\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"mongodb_rides__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    \n    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)\n AS ride_id,\n    CAST(\n        user_id AS INT\n    ) AS user_id,\n    cpf AS cpf,\n    CAST(\n        vehicle_id AS INT\n    ) AS vehicle_id,\n    \n    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)\n AS subscription_id,\n    \n    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)\n AS payment_id,\n    \n    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)\n AS stripe_id,\n    source AS source,\n    destination AS destination,\n    CAST(\n        price AS REAL\n    ) AS estimated_price,\n    surge_multiplier AS surge_multiplier,\n    CASE\n        WHEN surge_multiplier <> 1 THEN CAST(\n            price AS REAL\n        ) * surge_multiplier\n        ELSE CAST(\n            price AS REAL\n        )\n    END AS price,\n    NAME AS car_type,\n    cab_type AS service_type,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mongodb_rides_parquet\"\n    )", "query_id": "20241019_013401_00043_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.mongodb_rides", "compiled": true, "compiled_code": "\n\nSELECT\n    \n    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)\n AS ride_id,\n    CAST(\n        user_id AS INT\n    ) AS user_id,\n    cpf AS cpf,\n    CAST(\n        vehicle_id AS INT\n    ) AS vehicle_id,\n    \n    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)\n AS subscription_id,\n    \n    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)\n AS payment_id,\n    \n    CAST(FLOOR(random() * (10000 - 1 + 1)) + 1 AS INTEGER)\n AS stripe_id,\n    source AS source,\n    destination AS destination,\n    CAST(\n        price AS REAL\n    ) AS estimated_price,\n    surge_multiplier AS surge_multiplier,\n    CASE\n        WHEN surge_multiplier <> 1 THEN CAST(\n            price AS REAL\n        ) * surge_multiplier\n        ELSE CAST(\n            price AS REAL\n        )\n    END AS price,\n    NAME AS car_type,\n    cab_type AS service_type,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mongodb_rides_parquet\"", "relation_name": "\"iceberg\".\"landing\".\"mongodb_rides\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:05.688511Z", "completed_at": "2024-10-19T01:34:05.696911Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:05.699374Z", "completed_at": "2024-10-19T01:34:08.919285Z"}], "thread_id": "Thread-1", "execution_time": 3.2379751205444336, "adapter_response": {"_message": "SUCCESS", "rows_affected": 45, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.mongodb_stripe\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"mongodb_stripe__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS stripe_id,\n    UID AS identifier,\n    token AS card_type,\n    ccv AS card_ccv,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mongodb_stripe_parquet\"\n    )", "query_id": "20241019_013405_00047_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.mongodb_stripe", "compiled": true, "compiled_code": "\n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS stripe_id,\n    UID AS identifier,\n    token AS card_type,\n    ccv AS card_ccv,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mongodb_stripe_parquet\"", "relation_name": "\"iceberg\".\"landing\".\"mongodb_stripe\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:08.932821Z", "completed_at": "2024-10-19T01:34:08.944196Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:08.946384Z", "completed_at": "2024-10-19T01:34:12.361266Z"}], "thread_id": "Thread-1", "execution_time": 3.4352540969848633, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4500, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.mongodb_users\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"mongodb_users__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS id,\n    CAST(\n        user_id AS INT\n    ) AS user_id,\n    cpf AS cpf,\n    CONCAT(\n        first_name,\n        ' ',\n        last_name\n    ) AS full_name,\n    \n    CASE\n        WHEN email IS NULL THEN NULL\n        ELSE CONCAT(SUBSTRING(email, 1, 1), '*****', SUBSTRING(email, strpos(email, '@')))\n    END\n AS email,\n    gender AS gender,\n    phone_number AS phone_number,\n    \n    CONCAT('xxx-xx-', SUBSTRING(social_insurance_number, 8, 4))\n AS social_security_number,\n    date_of_birth AS date_of_birth,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mongodb_users_parquet\"\n    )", "query_id": "20241019_013408_00051_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.mongodb_users", "compiled": true, "compiled_code": "\n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS id,\n    CAST(\n        user_id AS INT\n    ) AS user_id,\n    cpf AS cpf,\n    CONCAT(\n        first_name,\n        ' ',\n        last_name\n    ) AS full_name,\n    \n    CASE\n        WHEN email IS NULL THEN NULL\n        ELSE CONCAT(SUBSTRING(email, 1, 1), '*****', SUBSTRING(email, strpos(email, '@')))\n    END\n AS email,\n    gender AS gender,\n    phone_number AS phone_number,\n    \n    CONCAT('xxx-xx-', SUBSTRING(social_insurance_number, 8, 4))\n AS social_security_number,\n    date_of_birth AS date_of_birth,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mongodb_users_parquet\"", "relation_name": "\"iceberg\".\"landing\".\"mongodb_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:12.376527Z", "completed_at": "2024-10-19T01:34:12.386358Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:12.388568Z", "completed_at": "2024-10-19T01:34:15.408686Z"}], "thread_id": "Thread-1", "execution_time": 3.039776086807251, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4484, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.mssql_credit_card\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"mssql_credit_card__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS credit_card_id,\n    CAST(\n        user_id AS INT\n    ) AS user_id,\n    UID AS tsn_uid,\n    credit_card_number AS credit_card_number,\n    CAST(\n        credit_card_expiry_date AS DATE\n    ) AS credit_card_expiry,\n    credit_card_type AS credit_card_type,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mssql_credit_card_parquet\"\n    )", "query_id": "20241019_013412_00055_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.mssql_credit_card", "compiled": true, "compiled_code": "\n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS credit_card_id,\n    CAST(\n        user_id AS INT\n    ) AS user_id,\n    UID AS tsn_uid,\n    credit_card_number AS credit_card_number,\n    CAST(\n        credit_card_expiry_date AS DATE\n    ) AS credit_card_expiry,\n    credit_card_type AS credit_card_type,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mssql_credit_card_parquet\"", "relation_name": "\"iceberg\".\"landing\".\"mssql_credit_card\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:15.420256Z", "completed_at": "2024-10-19T01:34:15.427197Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:15.429108Z", "completed_at": "2024-10-19T01:34:19.011504Z"}], "thread_id": "Thread-1", "execution_time": 3.597501039505005, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4500, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.mssql_users\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"mssql_users__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DISTINCT CAST(\n        user_id AS INT\n    ) AS user_id,\n    cpf AS cpf,\n    CONCAT(\n        first_name,\n        ' ',\n        last_name\n    ) AS full_name,\n    CAST(\n        date_birth AS DATE\n    ) AS date_of_birth,\n    city AS city,\n    country AS country,\n    company_name AS company_name,\n    job AS job,\n    phone_number AS phone_number,\n    time_zone AS time_zone,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mssql_users_parquet\"\n    )", "query_id": "20241019_013415_00059_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.mssql_users", "compiled": true, "compiled_code": "\n\nSELECT\n    DISTINCT CAST(\n        user_id AS INT\n    ) AS user_id,\n    cpf AS cpf,\n    CONCAT(\n        first_name,\n        ' ',\n        last_name\n    ) AS full_name,\n    CAST(\n        date_birth AS DATE\n    ) AS date_of_birth,\n    city AS city,\n    country AS country,\n    company_name AS company_name,\n    job AS job,\n    phone_number AS phone_number,\n    time_zone AS time_zone,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"mssql_users_parquet\"", "relation_name": "\"iceberg\".\"landing\".\"mssql_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:19.025153Z", "completed_at": "2024-10-19T01:34:19.032214Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:19.034450Z", "completed_at": "2024-10-19T01:34:22.408764Z"}], "thread_id": "Thread-1", "execution_time": 3.390507221221924, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4300, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.postgres_payments\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"postgres_payments__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DISTINCT CAST(\n        user_id AS INT\n    ) AS payment_id,\n    CASE\n        WHEN gender = 'm' THEN 'male'\n        ELSE 'female'\n    END AS gender,\n    LANGUAGE AS LANGUAGE,\n    race AS race,\n    job_title AS job_title,\n    city AS city,\n    country AS country,\n    currency AS currency,\n    credit_card_type AS credit_card_type,\n    CAST(REPLACE(subscription_price, '$', '') AS REAL) AS price,\n    TIME AS issued_at,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"postgres_payments_parquet\"\n    )", "query_id": "20241019_013419_00063_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.postgres_payments", "compiled": true, "compiled_code": "\n\nSELECT\n    DISTINCT CAST(\n        user_id AS INT\n    ) AS payment_id,\n    CASE\n        WHEN gender = 'm' THEN 'male'\n        ELSE 'female'\n    END AS gender,\n    LANGUAGE AS LANGUAGE,\n    race AS race,\n    job_title AS job_title,\n    city AS city,\n    country AS country,\n    currency AS currency,\n    credit_card_type AS credit_card_type,\n    CAST(REPLACE(subscription_price, '$', '') AS REAL) AS price,\n    TIME AS issued_at,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"postgres_payments_parquet\"", "relation_name": "\"iceberg\".\"landing\".\"postgres_payments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:22.424875Z", "completed_at": "2024-10-19T01:34:22.436749Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:22.440731Z", "completed_at": "2024-10-19T01:34:25.491222Z"}], "thread_id": "Thread-1", "execution_time": 3.07852840423584, "adapter_response": {"_message": "SUCCESS", "rows_affected": 43, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.postgres_subscription\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"postgres_subscription__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS subscription_id,\n    plan AS plan,\n    status AS status,\n    payment_method AS payment_method,\n    subscription_term,\n    payment_term,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"postgres_subscription_parquet\"\n    )", "query_id": "20241019_013422_00067_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.postgres_subscription", "compiled": true, "compiled_code": "\n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS subscription_id,\n    plan AS plan,\n    status AS status,\n    payment_method AS payment_method,\n    subscription_term,\n    payment_term,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"postgres_subscription_parquet\"", "relation_name": "\"iceberg\".\"landing\".\"postgres_subscription\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:25.513355Z", "completed_at": "2024-10-19T01:34:25.525731Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:25.529229Z", "completed_at": "2024-10-19T01:34:29.354027Z"}], "thread_id": "Thread-1", "execution_time": 3.8488526344299316, "adapter_response": {"_message": "SUCCESS", "rows_affected": 4300, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.postgres_vehicle\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"postgres_vehicle__dbt_tmp\"\n      \n      \n    as (\n      \n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS vehicle_id,\n    user_id AS user_id,\n    NAME AS NAME,\n    YEAR AS YEAR,\n    km_driven AS km_driven,\n    fuel AS fuel,\n    seller_type AS seller_type,\n    transmission AS transmission,\n    mileage AS mileage,\n    engine AS engine,\n    max_power AS max_power,\n    torque AS torque,\n    CAST(\n        seats AS INT\n    ) AS seats,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"postgres_vehicle_parquet\"\n    )", "query_id": "20241019_013425_00071_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.postgres_vehicle", "compiled": true, "compiled_code": "\n\nSELECT\n    DISTINCT CAST(\n        id AS INT\n    ) AS vehicle_id,\n    user_id AS user_id,\n    NAME AS NAME,\n    YEAR AS YEAR,\n    km_driven AS km_driven,\n    fuel AS fuel,\n    seller_type AS seller_type,\n    transmission AS transmission,\n    mileage AS mileage,\n    engine AS engine,\n    max_power AS max_power,\n    torque AS torque,\n    CAST(\n        seats AS INT\n    ) AS seats,\n    CAST(\n        dt_current_timestamp AS TIMESTAMP\n    ) AS last_updated\nFROM\n    \"minio\".\"landing\".\"postgres_vehicle_parquet\"", "relation_name": "\"iceberg\".\"landing\".\"postgres_vehicle\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:29.366763Z", "completed_at": "2024-10-19T01:34:29.374702Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:29.376832Z", "completed_at": "2024-10-19T01:34:29.714180Z"}], "thread_id": "Thread-1", "execution_time": 0.354672908782959, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.users\"} */\n\n  create or replace view\n    \"iceberg\".\"landing\".\"users\"\n  security definer\n  as\n    \n\nWITH mssql_users AS (\n\n    SELECT\n        *,\n        ROW_NUMBER() over (\n            ORDER BY\n                last_updated\n        ) AS rwn_id\n    FROM\n        \"iceberg\".\"landing\".\"mssql_users\"\n),\nmongodb_users AS (\n    SELECT\n        *,\n        ROW_NUMBER() over (\n            ORDER BY\n                last_updated\n        ) AS rwn_id\n    FROM\n        \"iceberg\".\"landing\".\"mongodb_users\"\n)\nSELECT\n    DISTINCT mssql.rwn_id AS user_id,\n    mssql.cpf AS cpf,\n    mssql.full_name AS full_name,\n    mssql.date_of_birth AS date_of_birth,\n    mssql.city AS city,\n    mssql.country AS country\nFROM\n    mssql_users AS mssql\n    INNER JOIN mongodb_users AS mongodb\n    ON mssql.user_id = mongodb.user_id\n  ", "query_id": "20241019_013429_00075_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.users", "compiled": true, "compiled_code": "\n\nWITH mssql_users AS (\n\n    SELECT\n        *,\n        ROW_NUMBER() over (\n            ORDER BY\n                last_updated\n        ) AS rwn_id\n    FROM\n        \"iceberg\".\"landing\".\"mssql_users\"\n),\nmongodb_users AS (\n    SELECT\n        *,\n        ROW_NUMBER() over (\n            ORDER BY\n                last_updated\n        ) AS rwn_id\n    FROM\n        \"iceberg\".\"landing\".\"mongodb_users\"\n)\nSELECT\n    DISTINCT mssql.rwn_id AS user_id,\n    mssql.cpf AS cpf,\n    mssql.full_name AS full_name,\n    mssql.date_of_birth AS date_of_birth,\n    mssql.city AS city,\n    mssql.country AS country\nFROM\n    mssql_users AS mssql\n    INNER JOIN mongodb_users AS mongodb\n    ON mssql.user_id = mongodb.user_id", "relation_name": "\"iceberg\".\"landing\".\"users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:29.729208Z", "completed_at": "2024-10-19T01:34:29.740061Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:29.742405Z", "completed_at": "2024-10-19T01:34:30.235616Z"}], "thread_id": "Thread-1", "execution_time": 0.5132536888122559, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.ride_transactions\"} */\n\n  create or replace view\n    \"iceberg\".\"landing\".\"ride_transactions\"\n  security definer\n  as\n    \n\nWITH user AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"users\"\n),\nvehicle AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_vehicle\"\n),\nsubscription AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_subscription\"\n),\nstripe AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"mongodb_stripe\"\n),\npayment AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_payments\"\n)\nSELECT\n    rides.ride_id AS ride_id,\n    rides.user_id AS user_id,\n    rides.vehicle_id AS vehicle_id,\n    rides.subscription_id AS subscription_id,\n    rides.stripe_id AS stripe_id,\n    rides.payment_id AS payment_id,\n    user.full_name AS user_full_name,\n    user.cpf AS user_cpf,\n    rides.source AS source,\n    rides.destination AS destination,\n    rides.estimated_price AS estimated_price,\n    rides.surge_multiplier AS dynamic_fare,\n    rides.price AS price,\n    vehicle.name AS vehicle_name,\n    vehicle.year AS vehicle_year,\n    vehicle.km_driven AS vehicle_km_driven,\n    vehicle.seats AS vehicle_seats,\n    subscription.plan AS subscription_plan,\n    subscription.status AS subscription_status,\n    subscription.payment_method AS subscription_payment_method,\n    stripe.identifier AS stripe_identifier,\n    stripe.card_type AS stripe_card_type,\n    payment.city AS payment_city,\n    payment.country AS payment_country,\n    payment.currency AS payment_currency,\n    payment.credit_card_type AS payment_credit_card_type,\n    payment.price AS payment_price\nFROM\n    \"iceberg\".\"landing\".\"mongodb_rides\" AS rides\n    LEFT OUTER JOIN USER AS USER\n    ON rides.user_id = USER.user_id\n    LEFT OUTER JOIN vehicle AS vehicle\n    ON rides.vehicle_id = vehicle.vehicle_id\n    LEFT OUTER JOIN subscription AS subscription\n    ON rides.subscription_id = subscription.subscription_id\n    LEFT OUTER JOIN stripe AS stripe\n    ON rides.stripe_id = stripe.stripe_id\n    LEFT OUTER JOIN payment AS payment\n    ON rides.payment_id = payment.payment_id\n  ", "query_id": "20241019_013429_00076_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.ride_transactions", "compiled": true, "compiled_code": "\n\nWITH user AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"users\"\n),\nvehicle AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_vehicle\"\n),\nsubscription AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_subscription\"\n),\nstripe AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"mongodb_stripe\"\n),\npayment AS (\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"postgres_payments\"\n)\nSELECT\n    rides.ride_id AS ride_id,\n    rides.user_id AS user_id,\n    rides.vehicle_id AS vehicle_id,\n    rides.subscription_id AS subscription_id,\n    rides.stripe_id AS stripe_id,\n    rides.payment_id AS payment_id,\n    user.full_name AS user_full_name,\n    user.cpf AS user_cpf,\n    rides.source AS source,\n    rides.destination AS destination,\n    rides.estimated_price AS estimated_price,\n    rides.surge_multiplier AS dynamic_fare,\n    rides.price AS price,\n    vehicle.name AS vehicle_name,\n    vehicle.year AS vehicle_year,\n    vehicle.km_driven AS vehicle_km_driven,\n    vehicle.seats AS vehicle_seats,\n    subscription.plan AS subscription_plan,\n    subscription.status AS subscription_status,\n    subscription.payment_method AS subscription_payment_method,\n    stripe.identifier AS stripe_identifier,\n    stripe.card_type AS stripe_card_type,\n    payment.city AS payment_city,\n    payment.country AS payment_country,\n    payment.currency AS payment_currency,\n    payment.credit_card_type AS payment_credit_card_type,\n    payment.price AS payment_price\nFROM\n    \"iceberg\".\"landing\".\"mongodb_rides\" AS rides\n    LEFT OUTER JOIN USER AS USER\n    ON rides.user_id = USER.user_id\n    LEFT OUTER JOIN vehicle AS vehicle\n    ON rides.vehicle_id = vehicle.vehicle_id\n    LEFT OUTER JOIN subscription AS subscription\n    ON rides.subscription_id = subscription.subscription_id\n    LEFT OUTER JOIN stripe AS stripe\n    ON rides.stripe_id = stripe.stripe_id\n    LEFT OUTER JOIN payment AS payment\n    ON rides.payment_id = payment.payment_id", "relation_name": "\"iceberg\".\"landing\".\"ride_transactions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:30.250031Z", "completed_at": "2024-10-19T01:34:30.257807Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:30.260064Z", "completed_at": "2024-10-19T01:34:33.880135Z"}], "thread_id": "Thread-1", "execution_time": 3.6368789672851562, "adapter_response": {"_message": "SUCCESS", "rows_affected": 1, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.most_used_payment_methods\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"most_used_payment_methods__dbt_tmp\"\n      \n      \n    as (\n      \n\nWITH transactions AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"ride_transactions\"\n)\nSELECT\n    trx.subscription_payment_method AS payment_method,\n    COUNT(*) AS total_transactions,\n    SUM(\n        trx.payment_price\n    ) AS total_price\nFROM\n    transactions AS trx\nWHERE\n    trx.payment_country IS NOT NULL\nGROUP BY\n    trx.subscription_payment_method\nORDER BY\n    total_price DESC\nLIMIT\n    10\n    )", "query_id": "20241019_013430_00077_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.most_used_payment_methods", "compiled": true, "compiled_code": "\n\nWITH transactions AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"ride_transactions\"\n)\nSELECT\n    trx.subscription_payment_method AS payment_method,\n    COUNT(*) AS total_transactions,\n    SUM(\n        trx.payment_price\n    ) AS total_price\nFROM\n    transactions AS trx\nWHERE\n    trx.payment_country IS NOT NULL\nGROUP BY\n    trx.subscription_payment_method\nORDER BY\n    total_price DESC\nLIMIT\n    10", "relation_name": "\"iceberg\".\"landing\".\"most_used_payment_methods\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:33.891901Z", "completed_at": "2024-10-19T01:34:33.898606Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:33.900684Z", "completed_at": "2024-10-19T01:34:38.014103Z"}], "thread_id": "Thread-1", "execution_time": 4.129318952560425, "adapter_response": {"_message": "SUCCESS", "rows_affected": 10, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.top_vehicles\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"top_vehicles__dbt_tmp\"\n      \n      \n    as (\n      \n\nWITH transactions AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"ride_transactions\"\n)\nSELECT\n    trx.vehicle_name AS vehicle_name,\n    COUNT(*) AS total_rides\nFROM\n    transactions AS trx\nWHERE\n    trx.payment_country IS NOT NULL\nGROUP BY\n    trx.vehicle_name\nORDER BY\n    total_rides DESC\nLIMIT\n    10\n    )", "query_id": "20241019_013433_00081_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.top_vehicles", "compiled": true, "compiled_code": "\n\nWITH transactions AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"ride_transactions\"\n)\nSELECT\n    trx.vehicle_name AS vehicle_name,\n    COUNT(*) AS total_rides\nFROM\n    transactions AS trx\nWHERE\n    trx.payment_country IS NOT NULL\nGROUP BY\n    trx.vehicle_name\nORDER BY\n    total_rides DESC\nLIMIT\n    10", "relation_name": "\"iceberg\".\"landing\".\"top_vehicles\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-19T01:34:38.028566Z", "completed_at": "2024-10-19T01:34:38.035687Z"}, {"name": "execute", "started_at": "2024-10-19T01:34:38.037698Z", "completed_at": "2024-10-19T01:34:42.006489Z"}], "thread_id": "Thread-1", "execution_time": 3.9854202270507812, "adapter_response": {"_message": "SUCCESS", "rows_affected": 44, "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.7.7\", \"profile_name\": \"minio\", \"target_name\": \"dev\", \"node_id\": \"model.dev.total_transactions_per_country\"} */\n\n  \n    \n\n    create table \"iceberg\".\"landing\".\"total_transactions_per_country__dbt_tmp\"\n      \n      \n    as (\n      \n\nWITH transactions AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"ride_transactions\"\n)\nSELECT\n    trx.payment_country AS country,\n    SUM(\n        trx.payment_price\n    ) AS total_price,\n    COUNT(\n        trx.payment_price\n    ) AS total_rides\nFROM\n    transactions AS trx\nWHERE\n    trx.payment_country IS NOT NULL\nGROUP BY\n    trx.payment_country\n    )", "query_id": "20241019_013438_00085_b5ver"}, "message": "SUCCESS", "failures": null, "unique_id": "model.dev.total_transactions_per_country", "compiled": true, "compiled_code": "\n\nWITH transactions AS (\n\n    SELECT\n        *\n    FROM\n        \"iceberg\".\"landing\".\"ride_transactions\"\n)\nSELECT\n    trx.payment_country AS country,\n    SUM(\n        trx.payment_price\n    ) AS total_price,\n    COUNT(\n        trx.payment_price\n    ) AS total_rides\nFROM\n    transactions AS trx\nWHERE\n    trx.payment_country IS NOT NULL\nGROUP BY\n    trx.payment_country", "relation_name": "\"iceberg\".\"landing\".\"total_transactions_per_country\""}], "elapsed_time": 41.21511125564575, "args": {"use_colors": true, "write_json": true, "printer_width": 80, "cache_selected_only": false, "debug": true, "log_level_file": "debug", "static_parser": true, "log_file_max_bytes": 10485760, "populate_cache": true, "print": true, "vars": {}, "partial_parse_file_diff": true, "profiles_dir": "/home/Neo/kuber/data/dags/dbt/owshq", "send_anonymous_usage_stats": true, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "invocation_command": "dbt run --debug", "partial_parse": true, "macro_debugging": false, "strict_mode": false, "quiet": false, "select": [], "indirect_selection": "eager", "defer": false, "favor_state": false, "introspect": true, "exclude": [], "log_format": "default", "show_resource_report": false, "which": "run", "version_check": true, "project_dir": "/home/Neo/kuber/data/dags/dbt/owshq", "log_format_file": "debug", "enable_legacy_logger": false, "log_path": "/home/Neo/kuber/data/dags/dbt/owshq/logs", "log_level": "info"}}